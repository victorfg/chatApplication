<div class="logo-div">
    <img src={{logo}} alt="logo" />
</div>

<div class="container">
    <div class="row margin-top-30">
        <div class="col-sm usuario-no-registrado">
            <div class="center-text">Usuario no registrado</div>
            <div class="margin-top-30">
                <div class="display-flex">
                    <img src={{avatar}} alt="Avatar" class="avatar cursor-pointer" id="avatarImg">
                    <div>
                        <form>
                            <div class="form-group">
                                <div id="drop_zone" ondrop="dropHandler(event);" ondragover="dragOverHandler(event);">
                                    Arrastra tu imagen para usarla como avatar
                                </div>
                                <span>...o selecciona un archivo a la vieja usanza</span>
                                <input type="file" class="form-control-file" id="exampleFormControlFile1" onchange="readURL(this);">
                            </div>
                        </form>
                    </div>
                </div>
                <div class="row justify-concent-center">
                    <div class="col-sm-10">
                        <input type="email" class="form-control" id="inputEmail3" placeholder="email">
                    </div>
                </div>
                <div class="button-enter">
                    <a href="/listaDeSalas" type="button" class="btn btn-light">Entrar</a>
                </div>
            </div>
        </div>
        <div class="col-sm usuario-registrado">
            <div class="center-text">Usuario registrado</div>
            <div class="margin-top-30">
                <div class="row justify-concent-center">
                    <div class="col-sm-10">
                        <input type="email" class="form-control" id="inputEmail3" placeholder="email">
                    </div>
                </div>
                <div class="row justify-concent-center margin-top-15">
                    <div class="col-sm-10">
                        <input type="password" class="form-control" id="exampleInputPassword1" placeholder="password">
                    </div>
                </div>
                <div class="button-enter">
                    <a href="/listaDeSalas" type="button" class="btn btn-light">Entrar</a>
                </div>
                <div class="separation"></div>
                <div class="button-enter">
                    <a href="/registrarUsuario" type="button" class="btn btn-light">Registrarse</a>
                </div>
            </div>
        </div>
    </div>
</div>
<script>
    function setImageFromFile(file) {
        var reader = new FileReader();

        reader.onload = function (e) {
            document.getElementById('avatarImg').src = e.target.result;
            saveImageToLocalStorage();
        }

        reader.readAsDataURL(file);
    }

    function readURL(input) {
        document.getElementById("avatarImg").style.display = "block";

        if (input.files && input.files[0]) {
            setImageFromFile(input.files[0]);
        }
    }

    function dropHandler(ev) {

        // Prevent default behavior (Prevent file from being opened)
        ev.preventDefault();

        if (ev.dataTransfer.items) {
            // Use DataTransferItemList interface to access the file(s)
            for (var i = 0; i < ev.dataTransfer.items.length; i++) {
                // If dropped items aren't files, reject them
                if (ev.dataTransfer.items[i].kind === 'file') {
                    var file = ev.dataTransfer.items[i].getAsFile();

                    setImageFromFile(file);
                }
            }
        }
    }

    function dragOverHandler(ev) {
        // Prevent default behavior (Prevent file from being opened)
        ev.preventDefault();
    }

    function getBase64Image(img) {
        var canvas = document.createElement("canvas");
        canvas.width = img.width;
        canvas.height = img.height;

        var ctx = canvas.getContext("2d");
        ctx.drawImage(img, 0, 0);

        var dataURL = canvas.toDataURL("image/png");

        return dataURL.replace(/^data:image\/(png|jpg);base64,/, "");
    }

    function saveImageToLocalStorage() {
        bannerImage = document.getElementById('avatarImg');
        imgData = getBase64Image(bannerImage);
        localStorage.setItem("avatar", imgData);
    }

    function loadImageFromLocalStorage(domElement) {
        var dataImage = localStorage.getItem('avatarImg');
        if (dataImage) {
            domElement.src = "data:image/png;base64," + dataImage;
        }
    }
</script>

<style>
    #drop_zone {
        border: 2px solid #dc3545;
        text-align: center;
        padding: 3px;
        margin: 5px;
        border-radius: 5px;
        font-weight: 500;
    }
</style>